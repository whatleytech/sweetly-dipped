---
description: Enforce small, high-quality commits with tests, lint, coverage, and concise messages
globs: ["**/*"]
alwaysApply: true
---

Commit policy
1. One cohesive task per commit (e.g., “Add PackagesTable component” or “Fix TreatsGrid test”).  
2. Keep diffs small: ≤ ≈300 total lines changed. Split larger work into logical chunks.

Commit-message rules
- Format: `<type>(scope): <subject>`  (no body lines unless absolutely needed).  
- Be descriptive yet succinct:  
  • Prefer a **single line**.  
  • Hard cap: 280 characters.  
  • Aim for ≈ 120 characters on average.  
Examples:  
  • `feat(landing): add CtaBand with responsive styles`  
  • `fix(treats): correct calorie typo in card copy`

Quality gate (run automatically before every commit)
  • `yarn lint` — zero eslint errors/warnings.  
  • `yarn type-check` — `tsc --noEmit` passes.  
  • `yarn test --coverage` — all tests green **and** total coverage ≥ 80 %.  
  • `yarn prettier --check '**/*.{ts,tsx,js,jsx,css,md}'` — formatting OK.

If any step fails:
  a. Fix the issue (code, tests, or config).  
  b. Re-run the checklist.  
  c. Commit only when everything is green.

Tooling notes
- Use Husky & lint-staged; install/setup automatically if absent:
  • `yarn add -D husky lint-staged`  
  • `husky install` then add a “pre-commit” hook running the checklist.
- Coverage via Vitest’s Istanbul integration; threshold configured in `vitest.config.ts`.

CI alignment
- GitHub Actions (or equivalent) must replicate the checklist and block pushes to `main` on failure.

Cursor must adhere to this workflow whenever it generates, edits, or removes code.